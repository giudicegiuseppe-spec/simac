<!DOCTYPE html>

<html lang="it"><head>
<title>Nuovo Contratto Simac</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="/logo.png" rel="icon" type="image/png"/>
<link href="/preventivatore/assets/fonts/css/fonts-4615247307143386908.css" rel="stylesheet"/>
<link href="/preventivatore/assets/fonts/css/fonts-9205542499395909428.css" rel="stylesheet"/>
<meta content="#004da1" name="theme-color"/>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-TSK09LKTYN');
        </script>
<link href="/preventivatore/assets/share/css/wizard.css" rel="stylesheet"/>
<!-- Compiled and minified CSS -->
<link href="/preventivatore/assets/share/css/nouislider.min.css" media="screen" rel="stylesheet" type="text/css"/>
<link href="/preventivatore/assets/share/css/materialize.min.css" rel="stylesheet"/>
<link href="/preventivatore/assets/share/css/materialize-fix.css" rel="stylesheet"/>
<link href="/preventivatore/assets/share/css/bootstrap-scope.css" rel="stylesheet"/>
<script src="/preventivatore/assets/share/js/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="/preventivatore/assets/share/js/jquery-ui-1.8.18.min.js" type="text/javascript"></script>
<!--Datatable-->
<!--<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css">    
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>-->
<!--<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.20/b-1.6.1/b-colvis-1.6.1/b-html5-1.6.1/b-print-1.6.1/datatables.min.css"/>-->
<link href="/preventivatore/assets/share/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css"/>
<link href="/preventivatore/assets/share/css/datatables.min.css" rel="stylesheet" type="text/css"/>
<link href="/preventivatore/assets/share/css/fixedHeader.dataTables.min.css" rel="stylesheet"/>
<!--<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.20/b-1.6.1/b-colvis-1.6.1/b-html5-1.6.1/b-print-1.6.1/datatables.min.js"></script>-->
<script src="/preventivatore/assets/share/js/jquery.dataTables.min.js" type="text/javascript"></script>
<script src="/preventivatore/assets/share/js/datatables.min.js" type="text/javascript"></script>
<script src="/preventivatore/assets/share/js/dataTables.fixedHeader.min.js" type="text/javascript"></script>
<!-- Compiled and minified JavaScript -->
<script src="/preventivatore/assets/share/js/materialize.min.js"></script>
<script src="/preventivatore/assets/share/js/select.js"></script>
<script src="/preventivatore/assets/share/js/nouislider.js" type="text/javascript"></script>
<!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.css" rel="stylesheet" media="all" />-->
<link href="/preventivatore/assets/fonts/css/fonts-5646924855556283803.css" rel="stylesheet"/>
<link href="/preventivatore/assets/share/css/b.css" media="all" rel="stylesheet"/>
<link href="/preventivatore/assets/fonts/css/fonts-4793446121656594806.css" rel="stylesheet"/>
<link href="/preventivatore/assets/share/css/f.css" media="all" rel="stylesheet"/>
<link href="/preventivatore/assets/share/css/media-queries.css" media="all" rel="stylesheet"/>
<script src="/preventivatore/assets/share/js/global-utils.js" type="text/javascript"></script>
<script src="/preventivatore/assets/share/js/fc-admin_ready.js" type="text/javascript"></script>
<script src="/preventivatore/assets/share/js/ricarica.js" type="text/javascript"></script>
<script src="/preventivatore/assets/share/js/note.js" type="text/javascript"></script>
<script type="text/javascript">
        home_url = "https://share.unionenergia.it";
        ajax_url = "https://share.unionenergia.it/ajax";
        show_review = false;        $(document).ready(function(){
            $("#sidenav li.Contratto").addClass("active");
        });
        role = "7";
    </script>
<!--<script src="https://cdn.tiny.cloud/1/2les3lkob41251x51q8127r447v02h45jbmz58ecckof4e5e/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>-->
<!--<script src="https://cdn.tiny.cloud/1/pktnwk7yochtu0e9dhaswzxgbjjifqn3fwoxgn080uv2skm3/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>-->
<!--<script src="https://cdn.tiny.cloud/1/qlca83t019cfirtwhd9a4pqhrlel48zu8z23fxgrlbiyjjtn/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>-->

    
    
<script src="/preventivatore/assets/share/js/contratto_fotovoltaico.js" type="text/javascript"></script>
<script src="/preventivatore/assets/app/auth.js"></script>
<link href="/preventivatore/mirror/custom.css" rel="stylesheet"/><style id="selectionModeStyle">
.selection-mode-toggle{position:fixed;bottom:16px;right:16px;z-index:9999;background:#ff5252;color:#fff;padding:10px 14px;border-radius:8px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2); user-select:none}
.selection-mode-toggle.active{background:#d32f2f}
</style></head><body class="Contratto fv lang_it"><script>(function(){try{var p=location.pathname;if(p.indexOf('/preventivatore/mirror/share.unionenergia.it/')===0){var np=p.replace('/preventivatore/mirror/share.unionenergia.it/','/preventivatore/mirror/');location.replace(np+location.search+location.hash);return;}if(p==='/preventivatore/mirror/fv/contratto-fotovoltaico'){location.replace(p+'.html'+location.search+location.hash);return;}}catch(e){}})();
(function(){function boot(){try{if(window.Auth){ if(!Auth.require()) return; Auth.renderSidebarUser(); }}catch(_){}} if(document.readyState==='loading') document.addEventListener('DOMContentLoaded', boot); else boot();})();</script><header class="r7">
<nav class="top-nav">
<div class="padding-container">
<div class="nav-wrapper">
<ul class="left" id="top_nav" style="width: 100%;">
<!--<li><a href="#" data-target="sidenav" class="sidenav-trigger"><i class="material-icons menu-icon">menu</i><span>Menu</span></a></li>-->
<li class="hide-mobile esci right-li" style="float: right;"><a href="/preventivatore/mirror/"><i class="material-icons">logout</i><span>Esci</span></a></li>
<!--
                    <li style="float: right; width: 1px; height: 22px; vertical-align: middle; margin-top: 13px; background: #fff;"><span></span></li>
                    <li style="float: right; color: #fff;" class="welcome"><a href="#" style="cursor: normal;">Benvenuto SAMANTHA (Agente)</a></li>-->
<!--<li style="float: right; width: 1px; height: 22px; vertical-align: middle; margin-top: 13px; background: #fff; margin-left: 1%;"><span></span></li>-->
<!--<li style="float: right; color: #fff;" id="top_search"><div id="search-wrapper"> 
                        <form action="#" method="POST" onsubmit="javascript: return null;">
                            <div>
                            <input type="text" class="text autocomplete" id="megasearch" name="find" placeholder="Cerca nel portale" />
                            <button type="submit" class="submit"><i class="material-icons">search</i></button>
                            <br class="clr" />
                            </div>
                        </form>
                        <div class="progress" id="mega-progress">
                            <div class="indeterminate"></div>
                        </div>
                    </li>-->
<br class="clr"/>
</ul>
</div>
</div>
</nav>

    
    
</header><ul class="sidenav" id="sidenav">
<div class="sidenav-profile-wrap">
<img alt="" class="logo" src="/logo.png" title=""/>
<!--<li><div class="divider"></div></li>-->
<!--<li><a class="subheader">Subheader</a></li>-->
<div class="avatar-wrap">
</div>
<div class="profile-link-wrap">
</div>
</div>
<li class=""><a href="/preventivatore/mirror/fv/contratto-fotovoltaico.html"><i class="material-icons left">roofing</i>Contratto</a></li><li><a href="/preventivatore/mirror/i-miei-preventivi.html"><i class="material-icons">folder</i> I miei preventivi</a></li>
<li><div class="divider"></div></li>
<hr/>
<li class="documenti-utili-union-smart-agenti"><a href="/preventivatore/mirror/listini.html"><img alt="Documento" class="u-icon" src="/preventivatore/doc_icon.png" style="width:20px; height:20px"/> Listini</a></li><li class="documenti-utili-union-smart"><a href="/preventivatore/mirror/schede-prodotti.html"><img alt="Documento" class="u-icon" src="/preventivatore/doc_icon.png" style="width:20px; height:20px"/> Schede Prodotti</a></li>
<li class="documenti-utili-reddito-energetico"><a href="/preventivatore/mirror/incentivi.html"><img alt="Documento" class="u-icon" src="/preventivatore/doc_icon.png" style="width:20px; height:20px"/> Incentivi</a></li>
<li class="documenti-utili-union-smart-finanziamenti"><a href="/preventivatore/mirror/finanziamenti.html"><img alt="Documento" class="u-icon" src="/preventivatore/doc_icon.png" style="width:20px; height:20px"/> Finanziamenti</a></li>
<li class="documenti-utili-union-smart-formazione-agenti"><a href="/preventivatore/mirror/formazione-agenti.html"><img alt="Documento" class="u-icon" src="/preventivatore/doc_icon.png" style="width:20px; height:20px"/> Formazione Agenti</a></li>
<li class="documenti-utili-union-smart-marketing-agenti"><a href="/preventivatore/mirror/marketing.html"><img alt="Documento" class="u-icon" src="/preventivatore/doc_icon.png" style="width:20px; height:20px"/> Marketing</a></li>
</ul><span id="sidenav-resize">
<i class="material-icons left">keyboard_arrow_left</i>
<i class="material-icons right">keyboard_arrow_right</i>
</span><div id="delta-fixed"></div><div id="wrap"><section class="section-bg title"><div class="title-wrap"><a class="hide_please home-link" href="/preventivatore/mirror/listini.html"><img alt="" class="page-title-logo" src="/logo.png" title=""/></a><h1 class="padding-container">Listini</h1></div></section><section class="section padding-container white-bg"><div class="row">
<div class="card-panel" style="border-radius:12px; padding:16px; width:100%; overflow:auto;">
  <table id="listini-table" class="display stripe" style="width:100%">
    <thead>
      <tr>
        <th>Listino</th>
        <th>Fase</th>
        <th>Potenza</th>
        <th>Inverter</th>
        <th>Valore contratto</th>
      </tr>
    </thead>
    <tbody>
      
    </tbody>
  </table>
  <div id="listini-empty" style="margin-top:12px; color:#777;">Caricamento dati da Excel…</div>
  <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script>
    (async function(){
      var $tbody = document.querySelector('#listini-table tbody');
      var empty = document.getElementById('listini-empty');
      function addRow(cells){
        var tr = document.createElement('tr');
        cells.forEach(function(text){
          var td = document.createElement('td');
          td.textContent = (text==null? '': text);
          tr.appendChild(td);
        });
        $tbody.appendChild(tr);
      }
      async function tryFetch(paths){
        for (const p of paths){
          try{
            const res = await fetch(p, {cache:'no-store'});
            if(res.ok) return res.arrayBuffer();
          }catch(_){ }
        }
        throw new Error('Nessun percorso Excel raggiungibile');
      }
      try{
        empty.textContent = 'Caricamento dati da Excel…';
        var buf = await tryFetch([
          '/preventivatore/mirror/data/Listino%20Simac.xlsx',
          'data/Listino%20Simac.xlsx',
          './data/Listino%20Simac.xlsx',
        ]);
        var wb = XLSX.read(buf, {type:'array'});
        // Scegli il foglio con più righe utili
        var best = {name:null, rows:[], count:0};
        wb.SheetNames.forEach(function(name){
          var ws = wb.Sheets[name];
          var rows = XLSX.utils.sheet_to_json(ws, {header:1, raw:true});
          var cnt = 0;
          for(var i=1;i<rows.length;i++){
            var r = rows[i]||[];
            var vals = [r[0], r[2], r[3], r[5], r[11]];
            if(vals.some(function(v){return v!=null && v!=='';})) cnt++;
          }
          if(cnt>best.count){ best = {name:name, rows:rows, count:cnt}; }
        });
        var rows = best.rows;
        if(!rows || rows.length<=1){
          empty.textContent = 'Nessun dato trovato nel file Excel.';
        } else {
          empty.textContent = 'Foglio: '+best.name+' | righe utili: '+best.count+' (in caricamento…)';
          for(var i=1;i<rows.length;i++){
            var r = rows[i] || [];
            var listino = r[0];
            var fase = r[2];
            var potenza = r[3];
            var inverter = r[5];
            var valore = r[11];
            if([listino,fase,potenza,inverter,valore].every(function(v){return v==null || v==="";})) continue;
            addRow([listino, fase, potenza, inverter, valore]);
          }
          if($tbody.children.length>0){ empty.style.display='none'; }
          else { empty.textContent = 'File Excel caricato ma nessuna riga valida da mostrare.'; }
        }
      }catch(e){
        console.error('Errore caricamento Excel', e);
        empty.textContent = 'Impossibile caricare i dati dal file Excel.';
      }finally{
        try{
          if(window.$ && $.fn && $.fn.DataTable){
            $('#listini-table').DataTable({
              paging: true,
              searching: true,
              info: false,
              language: { emptyTable: "" }
            });
          }
        }catch(_){ }
      }
    })();
  </script>
</div>
</div></section></div>
<!-- version: listini v=2025-10-31-2 -->
</body></html>